---
import '../styles/global.css';
import { UI, type Locale } from '/src/i18n/strings';

const { title = 'Site', locale = 'en' } = Astro.props as { title?: string; locale?: Locale };
const ui = UI[locale];

const path = Astro.url.pathname;
const isActive = (href: string) => (path === href ? 'active' : '');
---
<html lang={locale}>
  <head>
    <meta charset="utf-8" />
    <title>{title}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <a class="skip-link" href="#main">Skip to content</a>

    <header class="site-header" role="banner">
      <div class="container header-inner">
        <!-- LEFT: Brand only -->
        <div class="header-left">
          <div class="brand">Your Org</div>
        </div>

        <!-- CENTER: Main navigation (desktop); becomes drawer on mobile -->
        <div class="header-center">
          <nav id="site-nav" class="site-nav" role="navigation">
            <a id="nav-home" href="/" class={isActive('/')}
              aria-current={path === '/' ? 'page' : undefined}>{ui.nav.home}</a>
            <a id="nav-info" href="/furtherinformation" class={isActive('/furtherinformation')}
              aria-current={path === '/furtherinformation' ? 'page' : undefined}>{ui.nav.info}</a>
            <a id="nav-contact" href="/contact" class={isActive('/contact')}
              aria-current={path === '/contact' ? 'page' : undefined}>{ui.nav.contact}</a>

            <!-- MOBILE (drawer) language switch, centered at bottom -->
            <div class="lang-switch lang-switch--drawer" role="navigation" aria-label={ui.langLabel}>
              <a href="?lang=en" data-lang-switch="en" class={locale === 'en' ? 'active' : undefined}>{ui.langShort.en}</a>
              <a href="?lang=de" data-lang-switch="de" class={locale === 'de' ? 'active' : undefined}>{ui.langShort.de}</a>
              <a href="?lang=fr" data-lang-switch="fr" class={locale === 'fr' ? 'active' : undefined}>{ui.langShort.fr}</a>
            </div>
          </nav>
        </div>


        <!-- RIGHT: Desktop language switch + mobile hamburger -->
        <div class="header-right">
          <!-- DESKTOP language switch (far right) -->
          <nav class="lang-switch lang-switch--desktop" aria-label={ui.langLabel}>
            <a href="?lang=en" data-lang-switch="en" class={locale === 'en' ? 'active' : undefined}>{ui.langShort.en}</a>
            <a href="?lang=de" data-lang-switch="de" class={locale === 'de' ? 'active' : undefined}>{ui.langShort.de}</a>
            <a href="?lang=fr" data-lang-switch="fr" class={locale === 'fr' ? 'active' : undefined}>{ui.langShort.fr}</a>
          </nav>

          <!-- Mobile drawer toggle -->
          <button
            class="nav-toggle"
            aria-label="Open navigation menu"
            aria-controls="site-nav"
            aria-expanded="false"
          >
            â˜° <span class="sr-only">Menu</span>
          </button>
        </div>
      </div>
    </header>

    <div class="backdrop" id="backdrop" hidden></div>

    <main class="container" role="main" id="main" tabindex="-1">
      <slot />
    </main>

    <footer class="site-footer" role="contentinfo">
      <div class="container">
        <p>{ui.footer.contact}</p>
      </div>
    </footer>

    <!-- Drawer behavior -->
    <script type="module" src="/src/scripts/navDrawer.ts"></script>
    <!-- Language cookie / ?lang handling -->
    <script type="module" src="/src/scripts/langSwitch.ts"></script>
  </body>
</html>
